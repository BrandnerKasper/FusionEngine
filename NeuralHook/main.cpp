#include <torch/torch.h>
#include <torch/script.h>


std::string ex{
    R"(11111111111111111111111111111111
10000000000003000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000020000000000000001
10000000000000020000000000000001
10000000000000020000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
10000000000000000000000000000001
11111111111111111111111111111111)"
};

int main() {

    std::cout << ex << std::endl;
    torch::jit::script::Module model = torch::jit::load("pretrained_models/PNN_W.pt");
    model.eval();

    torch::Device device(torch::kCUDA);
    model.to(device);

    // Load example string as torch tensor with one hot encoding

    // make a single inference of the model

    // transform and save the result as a .png

    return 0;
}